<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Plebiscito no Chile</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Gian Lima</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://gianlima.github.io/">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    GLM 1-10
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Conteúdo de GLM</li>
    <li class="dropdown-header">Módulo 2 - Revisão de modelos lineares</li>
    <li>
      <a href="reacao_mod2.html">Reação química + tipos de embalagens (Modelo com erros normais)</a>
    </li>
    <li>
      <a href="venda_cos_mod2.html">Vendas de cosméticos (Modelo com erros normais)</a>
    </li>
    <li>
      <a href="min_qua_pon_mod3.html">Módulo 3 - Modelo linear com erros heterocedásticos</a>
    </li>
    <li class="dropdown-header">Módulo 6 - Estimação em modelos lineares generalizados</li>
    <li>
      <a href="estim_glm_mod6.html">Estimação em modelos lineares generalizados</a>
    </li>
    <li>
      <a href="sini_auto_mod6.html">Sinistros de Automóveis (Dados de contagens)</a>
    </li>
    <li>
      <a href="aval_qua_mod8.html">Módulo 8 - Análise de deviance</a>
    </li>
    <li>
      <a href="sel_var_mod9.html">Módulo 9 - Seleção de covariáveis</a>
    </li>
    <li>
      <a href="diag_mod10.html">Módulo 10 - Diagnóstico do ajuste de MLGs</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    GLM 11-15
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Módulo 11 - Regressão para dados binários</li>
    <li>
      <a href="besouro_mod11.html">Auditoria</a>
    </li>
    <li>
      <a href="besouro_mod11.html">Besouro da Farinha</a>
    </li>
    <li>
      <a href="estimacao_mod11.html">Estimação em MLG usando bootstrap</a>
    </li>
    <li>
      <a href="plebis_mod11.html">Plebiscito no Chile</a>
    </li>
    <li class="dropdown-header">Módulo 12 - Regressão para dados binários - predição</li>
    <li>
      <a href="credito_mod12.html">Análise de risco de crédito</a>
    </li>
    <li>
      <a href="base_mod12.html">Base de dados sobre spams</a>
    </li>
    <li class="dropdown-header">Módulo 13 - Regressão para dados de contagens</li>
    <li>
      <a href="queda_idoso_mod13.html">Quedas de idosos</a>
    </li>
    <li>
      <a href="cromo_mod13.html">Cromossomos anormais (Regressão Poisson com termo offset)</a>
    </li>
    <li class="dropdown-header">Módulo 14 - Regressão para dados de contagens com super dispersão</li>
    <li>
      <a href="super_disp_mod14.html">superdispersão (simulação)</a>
    </li>
    <li>
      <a href="exe_comp_mod14.html">Executivos compartilhados</a>
    </li>
    <li>
      <a href="Consulta_mod14.html">Número de consultas ao médico (Austrália)</a>
    </li>
    <li>
      <a href="ratos_mod14.html">Suplementação de ferro em ratos</a>
    </li>
    <li>
      <a href="cevada_mod14.html">Doença da cevada</a>
    </li>
    <li class="dropdown-header">Módulo 15 - Regressão para dados contínuos assimétricos</li>
    <li>
      <a href="turbina_mod15.html">Tempo de vida de turbinas de avião</a>
    </li>
    <li>
      <a href="tweedie_valor_sin_mod15.html">Valor de sinistros</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gianlima/r-exams-tutorial">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Plebiscito no Chile</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">require</span>(car)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">require</span>(MASS)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">require</span>(faraway)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">require</span>(effects)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">help</span>(Chile)</a></code></pre></div>
<p>Preparando os dados.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(Chile)</a></code></pre></div>
<pre><code>##   region population sex age education income statusquo vote
## 1      N     175000   M  65         P  35000     1.008    Y
## 2      N     175000   M  29        PS   7500    -1.296    N
## 3      N     175000   F  38         P  15000     1.231    Y
## 4      N     175000   F  49         P  35000    -1.032    N
## 5      N     175000   F  23         S  35000    -1.105    N
## 6      N     175000   F  28         P   7500    -1.047    N</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">summary</span>(Chile)</a></code></pre></div>
<pre><code>##  region     population     sex           age       education  
##  C :600   Min.   :  3750   F:1379   Min.   :18.0   P   :1107  
##  M :100   1st Qu.: 25000   M:1321   1st Qu.:26.0   PS  : 462  
##  N :322   Median :175000            Median :36.0   S   :1120  
##  S :718   Mean   :152222            Mean   :38.5   NA&#39;s:  11  
##  SA:960   3rd Qu.:250000            3rd Qu.:49.0              
##           Max.   :250000            Max.   :70.0              
##                                     NA&#39;s   :1                 
##      income         statusquo        vote    
##  Min.   :  2500   Min.   :-1.803   A   :187  
##  1st Qu.:  7500   1st Qu.:-1.002   N   :889  
##  Median : 15000   Median :-0.046   U   :588  
##  Mean   : 33876   Mean   : 0.000   Y   :868  
##  3rd Qu.: 35000   3rd Qu.: 0.969   NA&#39;s:168  
##  Max.   :200000   Max.   : 2.049             
##  NA&#39;s   :98       NA&#39;s   :17</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">Chile2 &lt;-<span class="st"> </span>Chile[<span class="kw">which</span>(Chile<span class="op">$</span>vote<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&#39;N&#39;</span>,<span class="st">&#39;Y&#39;</span>)),] </a></code></pre></div>
<p>Excluindo indecisos e eleitores que pretendem se abster.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">Chile2<span class="op">$</span>vote &lt;-<span class="st"> </span><span class="kw">factor</span>(Chile2<span class="op">$</span>vote) </a></code></pre></div>
<p>Eliminando níveis de ‘vote’ que não aparecem na nova amostra.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">summary</span>(Chile2)</a></code></pre></div>
<pre><code>##  region     population     sex          age       education 
##  C :384   Min.   :  3750   F:843   Min.   :18.0   P   :688  
##  M : 56   1st Qu.: 25000   M:914   1st Qu.:25.0   PS  :354  
##  N :237   Median :175000           Median :36.0   S   :708  
##  S :489   Mean   :151138           Mean   :38.1   NA&#39;s:  7  
##  SA:591   3rd Qu.:250000           3rd Qu.:49.0             
##           Max.   :250000           Max.   :70.0             
##                                                             
##      income         statusquo      vote   
##  Min.   :  2500   Min.   :-1.726   N:889  
##  1st Qu.: 15000   1st Qu.:-1.085   Y:868  
##  Median : 15000   Median :-0.169          
##  Mean   : 36768   Mean   : 0.004          
##  3rd Qu.: 35000   3rd Qu.: 1.172          
##  Max.   :200000   Max.   : 1.714          
##  NA&#39;s   :47       NA&#39;s   :3</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">Chile2<span class="op">$</span>education &lt;-<span class="st"> </span><span class="kw">factor</span>(Chile2<span class="op">$</span>education,<span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;P&#39;</span>,<span class="st">&#39;S&#39;</span>,<span class="st">&#39;PS&#39;</span>))</a></code></pre></div>
<p>Uma breve análise descritiva</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Chile2<span class="op">$</span>vote,Chile2<span class="op">$</span>region),<span class="dv">2</span>),<span class="dv">2</span>) </a></code></pre></div>
<pre><code>##    
##        C    M    N    S   SA
##   N 0.55 0.32 0.43 0.44 0.58
##   Y 0.45 0.68 0.57 0.56 0.42</code></pre>
<p>Tabela de frequências de intenção de voto segundo a região do eleitor.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">barplot</span>(<span class="kw">table</span>(Chile2<span class="op">$</span>vote,Chile2<span class="op">$</span>region), <span class="dt">beside=</span>T, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">350</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&#39;Região&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Nº de Eleitores&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Não&#39;</span>,<span class="st">&#39;Sim&#39;</span>)) </a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Gráfico de barras - intenção de voto vs região.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">barplot</span>(<span class="kw">table</span>(Chile2<span class="op">$</span>vote, Chile2<span class="op">$</span>sex), <span class="dt">beside =</span> T, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&#39;Sexo&#39;</span>,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">        <span class="dt">ylab =</span> <span class="st">&#39;Nº de Eleitores&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Não&#39;</span>,<span class="st">&#39;Sim&#39;</span>))</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Gráfico de barras - intenção de voto vs sexo</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">barplot</span>(<span class="kw">table</span>(Chile2<span class="op">$</span>vote, Chile2<span class="op">$</span>education), <span class="dt">beside =</span> T, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&#39;Escolaridade&#39;</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">        <span class="dt">ylab =</span> <span class="st">&#39;Nº de Eleitores&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Não&#39;</span>,<span class="st">&#39;Sim&#39;</span>))</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Gráfico de barras - intenção de voto vs Educação</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">boxplot</span>(Chile2<span class="op">$</span>age <span class="op">~</span><span class="st"> </span>Chile2<span class="op">$</span>vote, <span class="dt">xlab =</span> <span class="st">&#39;Voto&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Idade de eleitores&#39;</span>,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">        <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&#39;Não&#39;</span>,<span class="st">&#39;Sim&#39;</span>)) </a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Boxplot de idade versus intenção de voto.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">boxplot</span>(Chile2<span class="op">$</span>income <span class="op">~</span><span class="st"> </span>Chile2<span class="op">$</span>vote, <span class="dt">ylab =</span> <span class="st">&#39;Renda&#39;</span>)</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Boxplot de renda versus intenção de voto.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">boxplot</span>(Chile2<span class="op">$</span>statusquo <span class="op">~</span><span class="st"> </span>Chile2<span class="op">$</span>vote, <span class="dt">ylab =</span> <span class="st">&#39;Status quo&#39;</span>)</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Boxplot de statusquo versus intenção de voto.</p>
<p>Vamos ajustar um glm para a intenção de voto, considerando distribuição binomial com função de ligação logito.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">Chile3 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(Chile2) <span class="co"># Eliminando da base as linhas com NA&#39;s.</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">intvoto &lt;-<span class="st"> </span><span class="kw">glm</span>(vote <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="dt">data =</span> Chile3)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">summary</span>(intvoto) <span class="co"># Resumo do modelo ajustado. </span></a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = vote ~ ., family = binomial(link = &quot;logit&quot;), data = Chile3)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -3.201  -0.275  -0.134   0.203   2.862  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.05e+00   4.59e-01    2.28   0.0227 *  
## regionM      7.07e-01   6.02e-01    1.17   0.2403    
## regionN     -9.96e-02   3.59e-01   -0.28   0.7813    
## regionS     -3.04e-01   2.93e-01   -1.04   0.2985    
## regionSA    -3.01e-01   3.40e-01   -0.88   0.3762    
## population   1.28e-06   1.41e-06    0.90   0.3671    
## sexM        -5.52e-01   2.04e-01   -2.70   0.0069 ** 
## age          7.11e-04   7.47e-03    0.10   0.9242    
## educationS  -6.57e-01   2.44e-01   -2.69   0.0070 ** 
## educationPS -9.68e-01   3.46e-01   -2.80   0.0052 ** 
## income      -2.97e-06   2.86e-06   -1.04   0.2981    
## statusquo    3.23e+00   1.52e-01   21.18   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2360.29  on 1702  degrees of freedom
## Residual deviance:  703.48  on 1691  degrees of freedom
## AIC: 727.5
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Nota-se menor intenção de votos favoráveis ao regime dentre os homens, dentre os eleitores com maior escolaridade e maior intenção quanto maior o status-quo.</p>
<p>É evidente (e até mesmo previsível) que a variável statusquo seja extremamente relacionada à intenção de voto (no caso, ao voto favorável), sendo os efeitos das demais covariáveis bastante modestos se comparados a ela. O que aconteceria se tirássemos ela do modelo?</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">intvoto2 &lt;-<span class="st"> </span><span class="kw">update</span>(intvoto, <span class="op">~</span>. <span class="op">-</span>statusquo)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">summary</span>(intvoto2) </a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = vote ~ region + population + sex + age + education + 
##     income, family = binomial(link = &quot;logit&quot;), data = Chile3)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.960  -1.058  -0.619   1.065   1.983  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.10e-01   2.19e-01    0.50  0.61443    
## regionM      7.40e-01   3.24e-01    2.28  0.02258 *  
## regionN      6.48e-01   1.80e-01    3.61  0.00031 ***
## regionS      4.82e-01   1.47e-01    3.27  0.00108 ** 
## regionSA     5.08e-01   1.77e-01    2.87  0.00413 ** 
## population  -4.48e-06   7.45e-07   -6.01  1.8e-09 ***
## sexM        -5.87e-01   1.04e-01   -5.65  1.6e-08 ***
## age          1.52e-02   3.72e-03    4.09  4.3e-05 ***
## educationS  -5.10e-01   1.24e-01   -4.10  4.1e-05 ***
## educationPS -1.01e+00   1.70e-01   -5.94  2.8e-09 ***
## income       6.70e-06   1.40e-06    4.79  1.7e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2360.3  on 1702  degrees of freedom
## Residual deviance: 2160.4  on 1692  degrees of freedom
## AIC: 2182
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Observe que alguns efeitos que anteriormente não apresentavam significância estatística agora apresentam. Vamos optar pelo modelo sem a inclusão de statusquo.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">Anova</span>(intvoto2, <span class="dt">test =</span> <span class="st">&#39;LR&#39;</span>) </a></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: vote
##            LR Chisq Df Pr(&gt;Chisq)    
## region         19.2  4    0.00071 ***
## population     37.3  1    1.0e-09 ***
## sex            32.3  1    1.3e-08 ***
## age            16.8  1    4.0e-05 ***
## education      37.8  2    6.2e-09 ***
## income         23.4  1    1.3e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Os testes das razões de verossimilhanças indicam a significância estatística das variáveis incluídas no modelo.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">anova</span>(intvoto2, <span class="dt">test =</span> <span class="st">&#39;LR&#39;</span>) </a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: vote
## 
## Terms added sequentially (first to last)
## 
## 
##            Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)    
## NULL                        1702       2360             
## region      4     41.7      1698       2319  2.0e-08 ***
## population  1     38.3      1697       2280  6.0e-10 ***
## sex         1     35.2      1696       2245  2.9e-09 ***
## age         1     41.3      1695       2204  1.3e-10 ***
## education   2     19.9      1693       2184  4.7e-05 ***
## income      1     23.4      1692       2160  1.3e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Qual a diferença com relação ao comando acima mesmo?</p>
<p>Vamos avaliar possível efeito de interação entre sexo e educação:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">intvoto4 &lt;-<span class="st"> </span><span class="kw">update</span>(intvoto2, <span class="op">~</span><span class="st"> </span>. <span class="op">+</span>sex<span class="op">:</span>education)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">anova</span>(intvoto2, intvoto4, <span class="dt">test=</span><span class="st">&#39;LR&#39;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: vote ~ region + population + sex + age + education + income
## Model 2: vote ~ region + population + sex + age + education + income + 
##     sex:education
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1      1692       2160                     
## 2      1690       2158  2     2.57     0.28</code></pre>
<p>Repare no efeito não significativo da interação. Deixo como exercício verificar o efeito de alguma interação de interesse e, caso verificada a significância, incluí-la no modelo e analisar os resultados.</p>
<p>Exercício 1 - escrever a equação do modelo ajustado. Interpretar cada um dos coeficientes estimados.</p>
<p>Vamos calcular a probabilidade de intenção de voto pró-Pinochet para eleitores com os seguintes perfis:</p>
<p>Região C, População 25.000, Sexo masculino, idade 35 anos, com ensino superior, renda 120.000. Região M, População 50.000, Sexo feminino, idade 55 anos, com ensino primário, renda 15.000.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">datapred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">region =</span> <span class="kw">c</span>(<span class="st">&#39;C&#39;</span>,<span class="st">&#39;M&#39;</span>), <span class="dt">population =</span> <span class="kw">c</span>(<span class="dv">25000</span>,<span class="dv">50000</span>),</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">                       <span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&#39;M&#39;</span>,<span class="st">&#39;F&#39;</span>), <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">55</span>), <span class="dt">education =</span> <span class="kw">c</span>(<span class="st">&#39;S&#39;</span>,<span class="st">&#39;P&#39;</span>),</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">                       <span class="dt">income =</span> <span class="kw">c</span>(<span class="dv">120000</span>,<span class="dv">15000</span>))</a></code></pre></div>
<p>Criando um data frame para os dados que vamos predizer.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">predict</span>(intvoto2, <span class="dt">newdata=</span>datapred, <span class="dt">type=</span><span class="st">&#39;response&#39;</span>) </a></code></pre></div>
<pre><code>##      1      2 
## 0.5588 0.8268</code></pre>
<p>estimativas pontuais para as probabilidades de voto para os dois perfis.</p>
<p>Agora, vamos obter ICs 95% para as probabilidades correspondentes aos dois perfis de eleitores.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw">predict</span>(intvoto2,<span class="dt">newdata=</span>datapred,<span class="dt">type=</span><span class="st">&#39;link&#39;</span>,<span class="dt">se.fit=</span>T); p1 </a></code></pre></div>
<pre><code>## $fit
##      1      2 
## 0.2365 1.5629 
## 
## $se.fit
##      1      2 
## 0.1912 0.3178 
## 
## $residual.scale
## [1] 1</code></pre>
<p>Estimativas na escla do preditor, pedindo ao R os erros padrões.</p>
<p>Agora, vamos calcular os intervalos de confiança para as probabilidades estimadas.</p>
<p>Para o perfil 1:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">ic1 &lt;-<span class="st"> </span>p1<span class="op">$</span>fit[<span class="dv">1</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)<span class="op">*</span>p1<span class="op">$</span>se.fit[<span class="dv">1</span>] <span class="co"># Intervalo de confiança 95% para o preditor.</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">ilogit</span>(ic1) <span class="co"># Convertendo os limites para a escala de pi. </span></a></code></pre></div>
<pre><code>## [1] 0.4655 0.6482</code></pre>
<p>A função ilogit(x) calcula <span class="math inline">\(\frac{e^{x}}{e^{x}+1}\)</span></p>
<p>Para o perfil 2:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">ic2 &lt;-<span class="st"> </span>p1<span class="op">$</span>fit[<span class="dv">2</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)<span class="op">*</span>p1<span class="op">$</span>se.fit[<span class="dv">2</span>] <span class="co"># Intervalo de confiança 95% para o preditor.</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">ilogit</span>(ic2) </a></code></pre></div>
<pre><code>## [1] 0.7191 0.8990</code></pre>
<p>Convertendo os limites para a escala de pi.</p>
<p>O pacote effects dispõe de gráficos que permitem visualizar o efeito das covariáveis na resposta.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">effect</span>(<span class="st">&quot;income&quot;</span>, intvoto2), <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>) </a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Nesse gráfico, temos as probabilidades estimadas de votos pró-Pinochet (com ICs 95%) segundo a renda. Os valores das demais covariáveis são fixados na média (consultar a documentação da função para maiores detalhes).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">effect</span>(<span class="st">&quot;income&quot;</span>, intvoto2), <span class="dt">type =</span> <span class="st">&#39;link&#39;</span>) </a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Gráfico do efeito de renda na escala do preditor.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">effect</span>(<span class="st">&quot;age&quot;</span>, intvoto2), <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Gráfico para o efeito de idade.</p>
<p>Um pouco de diagnóstico.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">plot</span>(intvoto2, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="co"># Gráficos de diagnóstico padrão para a função glm</span></a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>(baseados nos resíduos componentes da deviance). Complicado avaliar.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">require</span>(car)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">influenceIndexPlot</span>(intvoto4, <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&#39;Studentized&#39;</span>,<span class="st">&#39;Cook&#39;</span>,<span class="st">&#39;Hat&#39;</span>), <span class="dt">id.n =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">1.4</span>)</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Não há indicativos fortes de out-liers ou observações influentes. Apenas como exercício, vamos verificar o indivíduo com identificação 2669, que produziu maior valor para a distância de Cook.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">Chile3[<span class="st">&#39;2669&#39;</span>,]</a></code></pre></div>
<pre><code>##      region population sex age education income statusquo vote
## 2669      M      87500   F  67         P   7500    -1.296    N</code></pre>
<p>Repare que é uma pessoa com características pró-Pinochet (mulher, 67 anos…), mas que vota não. Como a base é bastante grande, dificilmente essa observação tenha, sozinha, muita influência no ajuste. Mas, a título de esercício, vamos ajustar um novo modelo sem ela e comparar os resultados.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">intvoto22 &lt;-<span class="st"> </span><span class="kw">update</span>(intvoto2, <span class="dt">data =</span> Chile3[<span class="op">-</span><span class="kw">which</span>(<span class="kw">rownames</span>(Chile3) <span class="op">==</span><span class="st"> &#39;2669&#39;</span>),])</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">compareCoefs</span>(intvoto2, intvoto22) <span class="co"># Sem grandes mudanças.</span></a></code></pre></div>
<pre><code>## Calls:
## 1: glm(formula = vote ~ region + population + sex + age + education + 
##   income, family = binomial(link = &quot;logit&quot;), data = Chile3)
## 2: glm(formula = vote ~ region + population + sex + age + education + 
##   income, family = binomial(link = &quot;logit&quot;), data = 
##   Chile3[-which(rownames(Chile3) == &quot;2669&quot;), ])
## 
##               Model 1   Model 2
## (Intercept)     0.110     0.100
## SE              0.219     0.219
##                                
## regionM         0.740     0.819
## SE              0.324     0.330
##                                
## regionN         0.648     0.648
## SE              0.180     0.180
##                                
## regionS         0.482     0.483
## SE              0.147     0.148
##                                
## regionSA        0.508     0.506
## SE              0.177     0.177
##                                
## population  -4.48e-06 -4.46e-06
## SE           7.45e-07  7.45e-07
##                                
## sexM           -0.587    -0.592
## SE              0.104     0.104
##                                
## age           0.01521   0.01553
## SE            0.00372   0.00373
##                                
## educationS     -0.510    -0.512
## SE              0.124     0.124
##                                
## educationPS     -1.01     -1.01
## SE               0.17      0.17
##                                
## income       6.70e-06  6.67e-06
## SE           1.40e-06  1.40e-06
## </code></pre>
<p>Agora, vamos avaliar a qualidade do ajuste com base nos resíduos quantílicos aleatorizados e no gráfico do resíduo da deviance com envelope simulado.</p>
<div id="usando-os-resíduos-quantílicos" class="section level2">
<h2>Usando os resíduos quantílicos:</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">require</span>(statmod)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">residuos &lt;-<span class="st"> </span><span class="kw">qresiduals</span>(intvoto2)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="kw">qqnorm</span>(residuos)</a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="kw">qqline</span>(residuos)</a></code></pre></div>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Os resíduos apresentam boa aderência à distribuição Normal, indicativo de bom ajuste.</p>
</div>
<div id="agora-o-gráfico-de-resíduos-com-envelopes-simulados" class="section level2">
<h2>Agora o gráfico de resíduos com envelopes simulados</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">require</span>(hnp)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">hnp</span>(intvoto2) <span class="co"># Resíduos dispersos no interior dos envelopes simulados,</span></a></code></pre></div>
<pre><code>## Binomial model</code></pre>
<p><img src="plebis_mod11_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># sem qualquer padrão sistemático. Modelo bem ajustado.</span></a></code></pre></div>
<p>Para finalizar, vamos testar a qualidade do ajuste com base na estatística C de Hosmer e Lemeshow.</p>
<p>Função para o cálculo da Estatística (e teste) de qualidade de ajuste proposta por Hosmer e Lemeshow. Você deve entrar com o vetor de predições (na escala da resposta), o vetor de valores observados (zeros e uns) e o número de grupos (g) a serem formados.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">CHosmer &lt;-<span class="st"> </span><span class="cf">function</span>(modelo,g){</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">   respostas &lt;-<span class="st"> </span>modelo<span class="op">$</span>y</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">   preditos &lt;-<span class="st"> </span><span class="kw">predict</span>(modelo, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">   </a>
<a class="sourceLine" id="cb51-5" data-line-number="5">   dpred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(preditos, respostas) </a>
<a class="sourceLine" id="cb51-6" data-line-number="6">   <span class="co"># Dataframe com probabilidades estimadas e respostas para cada indivíduo.</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">   </a>
<a class="sourceLine" id="cb51-8" data-line-number="8">   dpred &lt;-<span class="st"> </span>dpred[<span class="kw">order</span>(dpred[,<span class="dv">1</span>]),] </a>
<a class="sourceLine" id="cb51-9" data-line-number="9">   <span class="co"># Ordenando as linhas do dataframe da menor para a maior probabilidade estimada.</span></a>
<a class="sourceLine" id="cb51-10" data-line-number="10">   </a>
<a class="sourceLine" id="cb51-11" data-line-number="11">   cortes &lt;-<span class="st"> </span><span class="kw">quantile</span>(dpred[,<span class="dv">1</span>], <span class="dt">probs=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span>g), <span class="dt">include.lowest=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb51-12" data-line-number="12">   <span class="co"># Calculando os quantis para as probabilidades estimadas, para posterior formação dos grupos.</span></a>
<a class="sourceLine" id="cb51-13" data-line-number="13">   </a>
<a class="sourceLine" id="cb51-14" data-line-number="14">   c1 &lt;-<span class="st"> </span><span class="kw">cut</span>(dpred[,<span class="dv">1</span>],<span class="dt">breaks=</span>cortes,<span class="dt">include.lowest=</span>T) </a>
<a class="sourceLine" id="cb51-15" data-line-number="15">   <span class="co"># Formando g grupos, de tamanhos (aproximadamente) iguais, com probabilidades </span></a>
<a class="sourceLine" id="cb51-16" data-line-number="16">   <span class="co"># estimadas semelhantes.</span></a>
<a class="sourceLine" id="cb51-17" data-line-number="17">   </a>
<a class="sourceLine" id="cb51-18" data-line-number="18">   Obs &lt;-<span class="st"> </span><span class="kw">tapply</span>(dpred[,<span class="dv">2</span>], c1, sum) </a>
<a class="sourceLine" id="cb51-19" data-line-number="19">   <span class="co"># Obs é um vetor com o número observado de respostas em cada um dos g grupos.</span></a>
<a class="sourceLine" id="cb51-20" data-line-number="20">   </a>
<a class="sourceLine" id="cb51-21" data-line-number="21">   pi &lt;-<span class="st"> </span><span class="kw">tapply</span>(dpred[,<span class="dv">1</span>], c1, mean) </a>
<a class="sourceLine" id="cb51-22" data-line-number="22">   <span class="co"># pi é um vetor com as médias das probabilidades estimadas em cada um dos g grupos.</span></a>
<a class="sourceLine" id="cb51-23" data-line-number="23">   </a>
<a class="sourceLine" id="cb51-24" data-line-number="24">   n &lt;-<span class="st"> </span><span class="kw">tapply</span>(dpred[,<span class="dv">1</span>], c1, length) </a>
<a class="sourceLine" id="cb51-25" data-line-number="25">   <span class="co"># n é um vetor com os tamanhos de amostras em cada grupo.</span></a>
<a class="sourceLine" id="cb51-26" data-line-number="26">   </a>
<a class="sourceLine" id="cb51-27" data-line-number="27">   Cchap &lt;-<span class="st"> </span><span class="kw">sum</span>(((Obs<span class="op">-</span>n<span class="op">*</span>pi)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi))) </a>
<a class="sourceLine" id="cb51-28" data-line-number="28">   <span class="co"># Estatística do teste de qualidade proposto por Hosmer e Lemeshow e</span></a>
<a class="sourceLine" id="cb51-29" data-line-number="29">   </a>
<a class="sourceLine" id="cb51-30" data-line-number="30">   pv &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(Cchap, g<span class="dv">-2</span>) <span class="co"># p-valor correspondente.</span></a>
<a class="sourceLine" id="cb51-31" data-line-number="31">   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">Cchap=</span>Cchap, <span class="dt">pvalue=</span>pv))</a>
<a class="sourceLine" id="cb51-32" data-line-number="32">}</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">CHosmer</span>(intvoto2,<span class="dt">g=</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## $Cchap
## [1] 4.37
## 
## $pvalue
## [1] 0.8223</code></pre>
<p><span class="math inline">\(C=4,37\)</span> que, com <span class="math inline">\(p-valor=0,822\)</span>. Assim, não se tem evidência significativa de falta de ajuste.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
